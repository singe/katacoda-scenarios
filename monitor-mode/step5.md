We can capture wifi traffic and crack handshakes, but if you want to "learn the trade and not the trick" it's good to understand what the traffic looks like.

The defacto tool for doing this is [wireshark](https://www.wireshark.org/) however, as we don't have access to a GUI in this tutorial, we're going to use a wireshark-like web application called [cloudshark](https://cloudshark.org/) as well as wireshark's command line client `tshark`.

## Cloudshark

You'll notice a tab above your terminal to the right of the `Terminal` tab called `Cloudshark`. Click on it and you'll be taken to a graphical view of your captured packets (it may take a few seconds to appear, if it doesn't load, click the blue `Display Port` button). Alternativley, you can access it directly [here](https://www.cloudshark.org/captures/cd37ad9b7280).

The view is broken into four layers:

* The top layer is where you can specify display filters or invoke other analysis tools
* The second layer gives you a scrollable/clickable list of all the frames you captured
* The third is a tree view of each layer of the individual frame highlighted, which can be expanded to show and interpretation of what it contains
* The last layer is the raw bytes in the frame

## Filtering In Cloudshark

In the previous step, we used the captured handshake messages to crack the password. Let's filter in on the handshake. This can be done by typing `eapol` into the text box at the top left of the Cloudshark screen where it says `Start typing a Display Filter`. When you're done, hit <kbd>Enter</kbd> or click `Apply`. Or you can click on [this link](https://www.cloudshark.org/captures/cd37ad9b7280?filter=eapol) to have it done for you.

You should see four frames with `(Message x of 4)` under the `Info` column. These are the four messages that make up the four-way handshake discussed in the previous step. Spend some time looking at what the frame is made up on in the third layer (you may need to drag the layers divider up to give you more space for viewing the detail).

We can also look at WiFi management frames to see devices attempting to connect to an access point. In particular, let's look for Probe Requests for a device looking for a named network. This makes use of a more complicated display filter `wlan.fc.type_subtype == 0x04`. The `0x04` says we're looking for a Probe Request. `0x08` would be a Beacon frame. Type in the new filter and click `Apply` or follow [this link](https://www.cloudshark.org/captures/cd37ad9b7280?filter=wlan.fc.type_subtype%20%3D%3D%200x04).

The first frame (No. 58) is from an Apple device, and set to all listening access points (aka Broadcast). Click on it, then click on the arrow next to `IEEE 802.11 wireless LAN` in the third frame to expand it. Next click on the arrow next to `Tagged parameters (25 bytes)` and next to the label `Tag: SSID parameter set:` you'll see that the probed for SSID was `Coherer`.

## Doing The Same With tshark

Let's switch back to our terminal, and repeat the above steps using `tshark` the command line interface for `wireshark`.

You can tell tshark to look at your capture file by passing it to the `-r` switch e.g.:
`tshark -r prac-01.cap`{{execute}}

If you named your capture file something else, make sure to change the file name in the above command.

You'll see tshark dump a summary of all the frames in that capture.

Now, let's filter in the same way we did with cloudshark. First, for `eapol` frames, with:
`tshark -r prac-01.cap 'eapol'`{{execute}}

Easy, right?

We can also filter for Probe Requests like we did with cloudshark with:
`tshark -r prac-01.cap 'wlan.fc.type_subtype == 0x04'`{{execute}}

You can look up other display filters at [wireshark's Display Filter Reference](http://wireshark.org/docs/dfref/w/wlan.html).

## Displaying Specific Fields

`tshark` can let you choose what to display about each frame. This is done using the `-T fields` switch, and specifying each field you want included in the output with `-e` switches. For example, `wlan.sa` is the MAC address of the device that sent a wireless frame. If we wanted to show just the sending address, we would do it like this:
`tshark -r prac-01.cap -T fields -e wlan.sa`{{execute}}

And if we wanted to add our filter in, just put it on the end as before:
`tshark -r prac-01.cap -T fields -e wlan.sa 'eapol'`{{execute}}

We can also add in more fields, for example, the SSID field is `wlan.ssid` if we wanted to show the sending address of SSID probed for, of all Probe Requests, it would be:
`tshark -r prac-01.cap -T fields -e wlan.sa -e wlan.ssid 'wlan.fc.type_subtype == 0x04'`{{execute}}

Phew.

## Capturing Live Packets With tshark

Up till now, we've been examining the packet capture generated by `airodump-ng`. But tshark can also capture frames for us. We do this by replacing the `-r prac-10.cap` with `-i mon0`. We also need to tell tshark to use display filters as a capture filter with the `-Y` switch. For example, if we just wanted to see the SSIDs of Probe Requests, we would do:
`tshark -i mon0 -T fields -e wlan.ssid -Y 'wlan.ssid != foo'`{{execute}}

You can stop a live capture with <kbd>Ctrl</kbd>+<kbd>c</kbd>.

## Next Step

Using what you've learned, can you find the SSID of at least one network other than `Coherer`? Write it to a file called `ssid` like this:
`echo thessid > ssid`{{execute}}

Note `thessid` above is merely an example, you'll need to replace it with what you found.
